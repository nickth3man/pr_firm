---
title: "pr_firm — document-project output"
---

This file is an automated extraction produced by the `document-project` task to support PRD creation. It summarizes the repository structure, runtime hints, high-level architecture, and recommended next steps.

- 1) High-Level Architecture

-------------------------

- Purpose: Formatting‑first content system that ingests a Brand Bible, produces per‑platform guidelines, scaffolds drafts via LLM, iterates edits to remove AI fingerprints, validates, and packages final deliverables.
- Core pipeline (implemented in `flow.py`/`nodes.py`):
  - EngagementManagerNode → BrandBibleIngestNode → VoiceAlignmentNode → FormatGuidelinesBatch → ContentCraftsmanNode → StyleEditorNode → StyleComplianceNode → (EditCycleReportNode if max revisions) → FactValidatorNode → BrandGuardianNode → AuthenticityAuditorNode → AgencyDirectorNode

2) Tech stack & runtime

-----------------------

- Language: Python 3.x
- LLM access: OpenRouter-compatible client (`utils/openrouter_client.py`) using environment variable `OPENROUTER_API_KEY` and optional `OPENROUTER_BASE_URL`/`OPENROUTER_MODEL`.
- Optional UI: Gradio (optional dependency used by `main.py` if installed).
- Notes: `utils/openrouter_client.get_client()` expects the `openai` package to be available (or compatible client).

3) Key files and responsibilities

--------------------------------

- `flow.py` — Assembles the PR flow and BatchFlow for platform guidelines.
- `nodes.py` — Implements all Node classes and business logic for each step.
- `main.py` — Example runner and Gradio wrapper for quick interactive runs.
- `utils/` — Utility modules:
  - `call_llm.py` (LLM wrapper)
  - `openrouter_client.py` (OpenRouter adapter)
  - `brand_bible_parser.py` / `brand_voice_mapper.py` (Brand Bible ingestion)
  - `format_platform.py` (platform guideline builder)
  - `rewrite_with_constraints.py` / `check_style_violations.py` (style enforcement)
  - `presets.py` (local presets store)
  - `streaming.py` (milestone streaming utility)
  - `progress.py`, `report_builder.py`
- `.bmad-core/templates/brownfield-prd-tmpl.yaml` — Brownfield PRD template (interactive; elicit: advanced-elicitation).

4) Source-tree snapshot

------------------------

- Top-level: `flow.py`, `nodes.py`, `main.py`, `utils/`, `docs/`, `web-bundles/`, `.bmad-core/`.
- Notable subfolders: `docs/prd/` (target location for PRD), `utils/` (implementations used by nodes), `web-bundles/agents/` (agent personas & templates).

5) Findings & gaps

-------------------

- `docs/prd.md` does not exist yet; `docs/prd/` has now two generated files: `pr_firm_document_project_analysis.md` and `document_project_output.md`.
- Some architecture documentation referenced by config (`docs/architecture/*.md`) may be missing; check `devLoadAlwaysFiles` in `.bmad-core/core-config.yaml` and add if needed.
- LLM credentials must be provided in environment for full runs (`OPENROUTER_API_KEY`).

6) Recommended next steps

-------------------------

1. Run the interactive `create-doc` flow with the `brownfield-prd-tmpl.yaml` template (I can do this now). The template requires step-by-step user confirmations for elicit:true sections.
2. If you want deeper automatic analysis (e.g., extract code-level call graphs, dependency tree, or list of third‑party packages), specify which artifacts to generate and I will produce them.

Generated by: automated `document-project` task (agent-run)
